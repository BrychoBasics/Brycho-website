<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brycho's Build Book - Valheim Building Inspiration | Brycho</title>
    <meta name="description" content="Brycho's collection of techniques and inspirations for usage in building.">

    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700;900&family=Lora:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Styles -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/build-book.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <!-- Header Navigation -->
    <header class="site-header">
    <div class="header-content">
        <button class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <div class="logo">
            <a href="index.html">
                <img src="images/Wordmark_small.png" alt="Brycho" style="height: 30px;">
            </a>
        </div>
        
        <nav class="main-nav">
            <a href="index.html">Home</a>
            <a href="valheim.html" class="active">Valheim</a>
        </nav>
        
        <div class="header-admin" id="headerAdmin" style="display: none;">
            <span class="user-info">Logged in as <span id="headerUserName"></span></span>
            <button onclick="logout()" class="btn-logout">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </div>
</header>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu">
        <a href="index.html">Home</a>
        <a href="valheim.html">Valheim</a>
        <a href="build-book.html" class="active">Brycho's Build Book</a>
        <a href="sign-center.html">Sign Center</a>
    </div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-header">
                <h1 class="page-title">Brycho's Build Book</h1>
                <button id="infoBtn" class="info-btn" title="About this project">
                    <i class="fas fa-info"></i>
                </button>
            </div>
        </div>
    </section>

    <!-- Filter Controls -->
    <section class="filter-section">
        <div class="container">
            <div class="filter-controls">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search techniques, styles, creators...">
                </div>

                <div class="filter-group">
                    <label class="filter-label">Mode:</label>
                    <div class="filter-mode-toggle">
                        <button id="filterModeAnd" class="filter-mode-btn active" data-mode="and">
                            <i class="fas fa-layer-group"></i> Match All
                        </button>
                        <button id="filterModeOr" class="filter-mode-btn" data-mode="or">
                            <i class="fas fa-grip-horizontal"></i> Match Any
                        </button>
                    </div>
                </div>

                <div class="filter-group">
                    <button id="showFiltersBtn" class="show-filters-btn">
                        <i class="fas fa-sliders-h"></i> Filters
                        <span class="active-filters-count" style="display: none;">0</span>
                    </button>
                </div>
                
                <div class="filter-group">
                    <button id="savedToggleBtn" class="saved-toggle-btn">
                        <i class="fas fa-bookmark"></i> Saved
                        <span class="saved-count">0</span>
                    </button>
                </div>

                <div class="filter-group">
                    <button id="clearFiltersBtn" class="clear-filters-btn">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>

                <div class="filter-group" id="uploadBtnGroup" style="display: none;">
                    <button id="uploadBtn" class="btn-primary">
                     <i class="fas fa-plus"></i> Upload
                    </button>
                </div>

                <div class="filter-group" id="tagsBtnGroup" style="display: none;">
    <button id="tagsBtn" class="btn-secondary">
        <i class="fas fa-tags"></i> Manage Tags
    </button>
</div>

            </div>

            <!-- Tag Filter Panel (Dynamically loaded) -->
<div id="tagFilterPanel" class="tag-filter-panel" style="display: none;">
    <!-- Categories will be loaded dynamically -->
</div>

            <!-- Results Counter -->
            <div class="results-counter">Loading...</div>
        </div>
    </section>

    <!-- Gallery Grid -->
    <section class="gallery-section">
        <div class="container">
            <div id="galleryGrid" class="gallery-grid">
                <!-- Gallery items will be dynamically inserted here -->
            </div>
            
            <!-- Pagination -->
            <div class="pagination">
                <!-- Pagination controls will be inserted here -->
            </div>
            
            <div id="noResults" class="no-results" style="display: none;">
                <i class="fas fa-search"></i>
                <p>No techniques found matching your filters.</p>
                <button id="resetFiltersBtn" class="btn-primary">Reset Filters</button>
            </div>

            <div id="loadingSpinner" class="loading-spinner">
                <i class="fas fa-hammer fa-spin"></i>
                <p>Loading Ideas...</p>
            </div>
        </div>
    </section>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="lightbox">
        <div class="lightbox-overlay"></div>
        <div class="lightbox-content">
            <button class="lightbox-close" aria-label="Close">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="lightbox-body">
                <div class="lightbox-images">
                    <div class="main-image-container">
                        <img id="lightboxMainImage" src="" alt="">
                    </div>
                    <div id="lightboxThumbnails" class="lightbox-thumbnails">
                        <!-- Additional images will appear here -->
                    </div>
                </div>
                
                <div class="lightbox-info">
                    <h2 id="lightboxTitle"></h2>
                    <p id="lightboxDescription" class="lightbox-description"></p>
                    
                    <div id="lightboxTags" class="lightbox-tags"></div>
                    
                    <div id="lightboxSource" class="lightbox-source"></div>

                    <button id="lightboxBookmark" class="btn-bookmark">
                        <i class="far fa-bookmark"></i> Save
                    </button>
                    
                    <div class="related-section">
                        <h3>Other ideas from this build</h3>
                        <div id="lightboxRelated" class="related-grid">
                            <!-- Related items will appear here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> About My Build Book</h2>
                <button class="modal-close" aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>For years I assembled a list of neat structures, both real and virtual, 
                    to use as inspiration while planning my <em>own</em> 
                    Valheim builds. Eventually the list became sluggish and 
                    generally insufficient for my needs, so I decided to vibe code 
                    my way into a web-based solution. As an added bonus, you get
                    to use it too! Welcome to my build book.
                </p>
                <p>Video embed goes here [EDIT NEEDED]</p>
                
                <h3 style="margin-top: var(--spacing-lg);">Getting Started</h3>
                <ul style="margin-left: var(--spacing-lg); color: var(--color-text-secondary);">
                    <li>Filter by application, component, and
                        (materials?)[EDIT NEEDED]. Whatever your use case!</li>
                    <li>Only see techniques that are possible with your current mods 
                        (some mods allow extra rotations) </li>
                    <li><strong>Save:</strong> Bookmark your favorites and filter with them later
                    (This is the only usage of cookies on this page.)</li>
                </ul>

                <p>
                    I've provided credit for all images I was able to, and would
                    encourage you to give the creators the support they deserve!
                    If you would prefer to not be featured, contact me at [EDIT NEEDED]
                </p>

                <p>
                    If you have any issues or feature requests, let me know by [EDIT NEEDED].
                    For the time being, this page won't see many updates as 
                    I'm trying not to take time away from my more interesting 
                    Valheim projects. With enough interest, however, I'm extremely
                    open to more community contributions, and I already have a lot
                    more ideas for this page that I'd love to explore!
                </p>
                <h3 style="margin-top: var(--spacing-lg);">Existing Feature Requests:</h3>
                <p>(Ranked from highest to lowest priority)</p>
                <ul style="margin-left: var(--spacing-lg); color: var(--color-text-secondary);">
            
                <li>Shareable link for bookmarks... opened link should prompt option to combine
                    bookmarks, replace existing, or idk, like view-only? Separate or same link
                    for sign center?
                </li>
                <li>Filterable tags based on rotations (from gizmo...)</li>
                <li>uhhh can't remember</li>
            </ul>
                
                
                <p>(maybe note something about how innovation comes from iteration and my best builds came from seeing
                    multiple techniques and combining them, so by sourcing ) [EDIT NEEDED]
                </p>

                
            </div>
        </div>
    </div>

    <!-- Admin Login Prompt -->
<div id="passwordPrompt" class="password-prompt hidden">
    <div class="password-header">
        <h3><i class="fas fa-user-shield"></i> Admin Login</h3>
        <button id="passwordClose" class="password-close">
            <i class="fas fa-times"></i>
        </button>
    </div>
    <div class="password-content">
        <label for="passwordInput">Enter admin or contributor password:</label>
        <input type="password" id="passwordInput" placeholder="Password">
        <button id="passwordSubmit" class="btn-primary">
            <i class="fas fa-sign-in-alt"></i> Login
        </button>
    </div>
</div>

    <!-- Scripts -->
    <script src="js/navigation.js"></script>
    <script src="js/bookmarks.js"></script>
    <script src="js/build-book.js"></script>
    <!-- <script src="js/site-password.js"></script> --> <!-- Uncomment to enable site protection -->

<!-- Upload Modal -->
<div id="uploadModal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
        <div class="modal-header">
            <h2><i class="fas fa-upload"></i> Upload New Idea</h2>
            <button class="modal-close" onclick="closeUploadModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <form id="uploadFormBuildBook" onsubmit="handleBuildBookUpload(event)">
                
                <div class="form-group">
                    <label>Idea Title</label>
                    <input type="text" id="uploadTitle" required maxlength="100">
                    <div class="title-helper">
                        <span id="titleCharCount">0/100</span>
                        <span id="titleWarning" style="display: none; color: var(--color-warning); font-size: 0.875rem;">
                            ðŸ’¡ Tip: Keep titles concise (1-2 lines). If your idea has many elements, consider splitting into multiple ideas!
                        </span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Images</label>
                    <div class="image-upload-zone required-empty" id="uploadDropZone">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h4>Drop images here or click to browse</h4>
                        <p>(5MB max file size)</p>
                        <input type="file" id="uploadImageInput" multiple accept="image/*" style="display: none;">
                    </div>
                    <div id="uploadPreviews" class="image-previews"></div>
                </div>
                
                <div class="form-group">
                    <label>Description (optional)</label>
                    <textarea id="uploadDescription"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Build (optional)</label>
                    <select id="uploadBuildSelect">
                        <option value="">None</option>
                        <option value="__new__">+ Create new build</option>
                    </select>
                    <input type="text" id="uploadNewBuildName" placeholder="New build name" style="display: none; margin-top: 8px;">
                </div>
                
                <div class="form-group">
                    <label>Tags (select all applicable)</label>
                    <div id="uploadAvailableTags" class="available-tags"></div>
                </div>
                
                <div class="form-group">
                    <label>Who should be credited with this idea?</label>
                    <div class="source-toggle">
                        <button type="button" class="source-toggle-btn active" data-source="mine" onclick="toggleSourceType('mine')">
                            Me
                        </button>
                        <button type="button" class="source-toggle-btn" data-source="found" onclick="toggleSourceType('found')">
                            Someone else
                        </button>
                    </div>
                </div>

                <div class="form-group" id="uploadCreatorGroup">
                    <label style="display: flex; align-items: center; gap: 8px;">Creator's Name
                        <button type="button" class="info-btn-small" onclick="showCreatorInfo()" title="Creator's name requirements">
                            <i class="fas fa-info"></i>
                        </button>
                    </label>
                    <input type="text" id="uploadCreator" list="creatorList" autocomplete="off" required>
                    <datalist id="creatorList"></datalist>
                </div>

                <div class="form-group" id="uploadLinkGroup">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        Source Link
                        <button type="button" class="info-btn-small" onclick="showLinkInfo()" title="Link requirements">
                            <i class="fas fa-info"></i>
                        </button>
                    </label>
                    <input type="url" id="uploadSourceLink">
                </div>
                
                <div class="form-group">
                    <label>Upload Notes (optional)</label>
                    <textarea id="uploadNotes" placeholder="Notes for admin review (tag suggestions, etc.)"></textarea>
                </div>
                
                <div class="form-group" id="uploadProtectedGroup">
                    <label>
                        <input type="checkbox" id="uploadProtected">
                        Protected (only visible when logged in)
                    </label>
                </div>

                <button type="submit" class="btn-primary" style="width: 100%; font-size: 1.125rem; padding: var(--spacing-md);">
                    <i class="fas fa-check"></i> Submit for review
                </button>
            </form>
        </div>
    </div>
</div>

<!-- Tags Management Modal -->
<div id="tagsModal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
        <div class="modal-header">
            <h2><i class="fas fa-tags"></i> Manage Tags</h2>
            <button class="modal-close" onclick="closeTagsModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="tags-manager">
                <div class="tags-header">
                    <button class="btn-primary" onclick="openCategoryModal()">
                        <i class="fas fa-plus"></i> Add Category
                    </button>
                </div>

                <div id="categoriesContainer" class="categories-container">
                    <!-- Categories load here -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Tag Edit Modal -->
<div id="tagEditModal" class="modal">
    <div class="modal-overlay"></div>
    <div class="modal-content" style="max-width: 500px;">
        <div class="modal-header">
            <h2 id="tagModalTitle">Manage Tags</h2>
            <button class="modal-close" onclick="closeTagEditModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label id="tagModalLabel">Name</label>
                <input type="text" id="tagModalInput">
            </div>
            <div class="form-group" id="categorySelectGroup" style="display:none;">
                <label>Category</label>
                <select id="tagModalCategory"></select>
            </div>
            <button class="btn-primary" onclick="saveTagModal()" style="width:100%;">
                Save
            </button>
        </div>
    </div>
</div>

<!-- Toast Notification -->
<div id="toast" class="toast"></div>


<!-- Toast Notification -->
<div id="toast" class="toast"></div>



    <!-- Toast Notification -->
<div id="toast" class="toast"></div>

<!-- Scripts -->
<script src="js/navigation.js"></script>


</body>
</html>
